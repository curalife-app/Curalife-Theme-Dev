<div class="supplements">
  <div class="container" >
    <div class="supplement-tech-wrapper">
      <div class="wrapper">
        <div class="taeb-switch left">
          <div class="taeb active-button" taeb-direction="left">{{ section.settings.button_left_text }}</div>
          <div class="taeb" taeb-direction="right">{{ section.settings.button_right_text }}</div>
        </div>
      </div>

      <div id="screen1" class="screen screen1">
        <div class="tabbed-content desktop-version">
          <nav class="tabs">
            {% assign desktop_left = section.blocks | where: 'type', 'slds_desktopl' %}
              <ul>
                {% for block in desktop_left %}
                <li><span>{{ block.settings.number_desktopl }}</span><h6><a href="{{ block.settings.link_desktopl }}" class="{% if forloop.first %}active{% endif %}">{{ block.settings.title_desktopl }}</a></h6></li>
                {% endfor %}
              </ul>
           
          <div class="content">
            {% assign contents_desktopl = section.blocks | where: 'type', 'contents_desktopl' %}
            {% for block in contents_desktopl %}
              <div id="{{ block.settings.linked_iddl }}" class="item {% if forloop.first %} active {% endif %}">
                <p class="relative z-40">{{ block.settings.content_dl }}</p>
                <img class="absolute z-0 desktop-img" src="{{ block.settings.image_dl | img_url: 'master'  }}" width="464" height="468" alt="">
              </div>
            {% endfor %}
              
          </div>
        </div>

      <div class="tabbed-content mobile-version">
          <nav class="tabs">
            {% assign slds_ml = section.blocks | where: 'type', 'slds_ml' %}
            <ul>
              {% for block in slds_ml %}
              <li><span>{{ block.settings.number_ml }}</span><h6><a href="{{ block.settings.link_ml }}" class="{% if forloop.first %}active{% endif %}">{{ block.settings.title_ml }}</a></h6></li>
              <div class="content">
                <div id="{{ block.settings.linked_idml }}" class="item">
                  <p>{{ block.settings.content_ml }}</p>
                  <img class="mobile-img" src="{{ block.settings.image_ml | img_url: 'master'  }}" width="464" height="468" alt="">
                </div>
              </div>
              {% endfor %}   
            </ul>
          </nav>
        </div> 
      </div>

      <div id="screen2" class="screen screen2" style="display:none;">
        <div class="tabbed-content desktop-version">
            <nav class="tabs">
              {% assign desktop_right = section.blocks | where: 'type', 'slds_desktopr' %}
              <ul>
                {% for block in desktop_right %}
                <li><span>{{ block.settings.number_desktopr }}</span><h6><a href="{{ block.settings.link_desktopr }}" class="{% if forloop.first %}active{% endif %}">{{ block.settings.title_desktopr }}</a></h6></li>
                {% endfor %}
              </ul>
            </nav>
            <div class="content">
              {% assign contents_desktopr = section.blocks | where: 'type', 'contents_desktopr' %}
              {% for block in contents_desktopr %}
                <div id="{{ block.settings.linked_iddr }}" class="item {% if forloop.first %} active {% endif %}">
                  <p class="relative z-40">{{ block.settings.content_dr }}</p>
                  <img class="absolute z-0 desktop-img" src="{{ block.settings.image_dr | img_url: 'master'  }}" width="464" height="468" alt="">
                </div>
              {% endfor %}
             
            </div>
          </div>
        <div class="tabbed-content mobile-version">
          <nav class="tabs">
            {% assign slds = section.blocks | where: 'type', 'slds' %}
              <ul>
                {% for block in slds %}
                <li><span>{{ block.settings.number }}</span><h6><a href="{{ block.settings.lnk }}" class="{% if forloop.first %}active{% endif %}">{{ block.settings.ttl }}</a></h6></li>
                <div class="content">
                  <div id="{{ block.settings.linked_idml }}" class="item">
                    <p>{{ block.settings.cnt }}</p>
                    <img class="mobile-img" src="{{ block.settings.imgmr | img_url: 'master'  }}" width="464" height="468" alt="">
                  </div>
                </div>
                {% endfor %}   
              </ul>
 
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .supplement-tech-wrapper {
    border: 1px solid #E8E8B0;
    box-shadow: 0px 4px 20px rgba(0, 0, 0, 0.15);
    border-radius: 20px;
    overflow: hidden;
  }

  .taeb-switch {
    position: relative;
    display: flex;
  }

  .supplements li:has(> h6 a.active) {
    font-weight: bold;
    color: var(--light-green)
  }

  .taeb-switch:after {
    content: "";
    position: absolute;
    width: 50%;
    top: 0;
    transition: left cubic-bezier(.88, -.35, .565, 1.35) .4s;
    border-radius: 37px;
    border: 1px solid #404733;
    height: 100%;
    z-index: 0;
    background: #404733;
  }

  .taeb-switch.left:after {
    left: 0;
  }

  .taeb-switch.right:after {
    left: 50%;
  }

  .taeb-switch.left.active-button:after {
    left: 50%;
  }

  .taeb-switch.right.active-button:after {
    left: 0;
  }

  .taeb-switch .taeb {
    display: inline-block;
    width: 50%;
    z-index: 1;
    padding: 10px;
    position: relative;
    cursor: pointer;
    transition: color 200ms;
    line-height: normal;
    user-select: none;
    font-weight: 700;
    text-align: center;
  }

  .taeb-switch .taeb.active-button {
    color: #ffffff;
  }

  .wrapper {
    border-radius: 37px;
    border: 1px solid var(--dark-green);
    width: 100%;
    max-width: 500px;
    margin: 20px auto;
  }

  .text-center {
    text-align: center;
  }

  @media screen and (max-width: 768px) {
    .wrapper {
      max-width: 90%;
    }

    .taeb-switch .taeb {
      padding: 2vw;
    }
  }

  .tabbed-content.desktop-version {
    display: flex;
    padding-left: 20px;
    gap: 20px;
    position: relative;
  }

  .tabbed-content.mobile-version {
    display: none;
  }

  .tabs {
    display: flex;
    min-width: 30%;
    margin-bottom: 1rem;
    position: relative;
  }

  .border-green {
    border-top: 1px solid var(--light-green);
  }

  .tabs li {
    border-bottom: 1px solid var(--light-green);
    display: flex;
    padding: 20px;
    gap: 20px;
    align-items: center;
  }

  .tabs li span {
    min-width: 15px;
  }

  .tabs li:last-of-type {
    border-bottom: unset;
  }

  .tabs h6 {
    font-weight: lighter;
    margin: unset;
  }

  .tabs a.active {
      color: #9EB069;
      font-weight: bold;
  }

  .content {
    background: #F9F9F9;
    display: flex;
    padding: 20px;
    width: 100%;
  }

  .content .item {
    display: none;
  }

  .content .item.active {
    display: flex;
  }

  .content p {
    max-width: 350px;
    z-index: 5;
  }

  .desktop-img {
    max-width: 60%;
    position: relative;
    right: 0;
    bottom: 0;
    position: absolute;
    max-height: 100%;
    object-fit: scale-down;
    object-position: right;
    }

  @media screen and (max-width: 768px) {
    .mobile-img {
      width: 100%;
      max-height: 400px;
      object-fit: cover;
      object-position: top;
    }

    .tabs {
      margin-bottom: unset;
    }
    .content {
      padding: unset;
    }

    .tabbed-content.desktop-version {
      display: none;
    }

    .tabbed-content.mobile-version {
      display: flex;
    }
    .tabbed-content {
      flex-direction: column;
    }

    .border-green {
      display: none;
      margin-left: 2vw;
      width: 88vw;
    }

    .tabs ul {
      width: 100%;
    }

    .tabs li {
      padding: 2vw;
    }

    .tabs li span {
      padding-inline-start: 10px;
    }

    .tabs h6 {
      padding: 3vw 0;
      max-width: 70%;
    }

    .tabs li:has(> a.active) {
      border-bottom: unset;
      box-shadow: 0 5px 5px rgb(0 0 0 / 3%);
      z-index: 100;
      position: relative;
    }

    .tabs a::after{
      position: absolute;
      right: 5vw;
      content: "+";
      font-size: 7vw;
      color: #9EB069;
      transition: transform 0.5s;
    }

    .tabs a.active::after {
      color: #9EB069;
      transform: rotate(45deg);
    }

    .content p {
      max-width: unset;
      padding: 3vw;
    }

    .content .item.active {
      flex-direction: column;
    }
  }
</style>

<script>
  var taeb = $(".taeb-switch");
  taeb.find(".taeb").on("click", function() {
    console.log("function"  );
  var $this = $(this);

    if ($this.hasClass("active-button")) return;

    var direction = $this.attr("taeb-direction");

    console.log("direction: "+direction)

    taeb.removeClass("left right").addClass(direction);
    taeb.find(".taeb.active-button").removeClass("active-button");
    $this.addClass("active-button");
  });
</script>

<script>
  // Get the List and Map buttons
  var suplBtn = document.querySelector('.taeb-switch .taeb[taeb-direction="left"]');
  var techBtn = document.querySelector('.taeb-switch .taeb[taeb-direction="right"]');

  // Get the screens
  var screen1 = document.getElementById('screen1');
  var screen2 = document.getElementById('screen2');

  // Add click event listeners to the buttons
  suplBtn.addEventListener('click', function() {
    // Set the List button to active
    suplBtn.classList.add('active-button');
    techBtn.classList.remove('active-button');

    // Show screen1 and hide screen2
    screen1.style.display = 'block';
    screen2.style.display = 'none';
  });

  techBtn.addEventListener('click', function() {
    // Set the Map button to active
    techBtn.classList.add('active-button');
    suplBtn.classList.remove('active-button');

    // Show screen2 and hide screen1
    screen2.style.display = 'block';
    screen1.style.display = 'none';
  });
</script>

<script>
  $(document).ready(function() {
    const tabs = $(".tabs a");
    const items = $(".content .item");

    // Use matchMedia to detect screen width
    const isDesktop = window.matchMedia('(min-width: 768px)').matches;

    // Attach click event listener to tabs only on desktop but allow toggling when clicking on currently active elements for mobile
    tabs.on("click", function(event) {
      event.preventDefault();
      const target = $($(this).attr("href"));
      const isActive = target.hasClass("active");

      if (!(isDesktop && isActive)) {
        tabs.removeClass("active");
        items.removeClass("active");

        if (!isActive) {
          $(this).addClass("active");
          target.addClass("active");
        }

      } else {
        if (!isActive) {
          target.removeClass("active");
          $(this).removeClass("active");
        }
      }
    });
  });
</script>

{% schema %}
{
   "name":"Supplements",
   "tag":"section",
   "class":"supplements",
   "disabled_on":{
      "groups":[
         "header",
         "footer"
      ]
   },
   "settings":[
      {
         "type":"color",
         "id":"bg_color",
         "label":"Background Color"
      },
      {
         "type":"text",
         "id":"button_left_text",
         "label":"Button 1",
         "default":"Supplement"
      },
      {
         "type":"text",
         "id":"button_right_text",
         "label":"Button 2",
         "default":"Tech"
      }
   ],
   "blocks":[
      {
         "name":"Slides Left Screen",
         "type":"slds_desktopl",
         "settings":[
            {
               "type":"text",
               "id":"link_desktopl",
               "label":"Link Desktop Left"
            },
            {
               "type":"text",
               "id":"number_desktopl",
               "label":"Number Desktop Left"
            },
            {
               "type":"text",
               "id":"title_desktopl",
               "label":"Title Desktop Left"
            }
         ]
      },
      {
         "name":"Content Left Screen",
         "type":"contents_desktopl",
         "settings":[
            {
               "type":"text",
               "id":"linked_iddl",
               "label":"Linked ID Desktop Left"
            },
            {
               "type":"richtext",
               "id":"content_dl",
               "label":"Content Desktop Left"
            },
            {
               "type":"image_picker",
               "id":"image_dl",
               "label":"Image Desktop Left"
            }
         ]
      },
      {
         "name":"Slides Right Screen",
         "type":"slds_desktopr",
         "settings":[
            {
               "type":"text",
               "id":"link_desktopr",
               "label":"Link Desktop Right"
            },
            {
               "type":"text",
               "id":"number_desktopr",
               "label":"Number Desktop Right"
            },
            {
               "type":"text",
               "id":"title_desktopr",
               "label":"Title Desktop Right"
            }
         ]
      },
      {
         "name":"Content Right Screen",
         "type":"contents_desktopr",
         "settings":[
            {
               "type":"text",
               "id":"linked_iddr",
               "label":"Linked ID Desktop Right"
            },
            {
               "type":"richtext",
               "id":"content_dr",
               "label":"Content Desktop Right"
            },
            {
               "type":"image_picker",
               "id":"image_dr",
               "label":"Image Desktop Right"
            }
         ]
      },
      {
         "name":"Slides Left Screen Mobile",
         "type":"slds_ml",
         "settings":[
            {
               "type":"text",
               "id":"link_ml",
               "label":"Link Mobile Left"
            },
            {
               "type":"text",
               "id":"number_ml",
               "label":"Number Mobile Left"
            },
            {
               "type":"text",
               "id":"title_ml",
               "label":"Title Mobile Left"
            },
            {
               "type":"text",
               "id":"linked_idml",
               "label":"Linked ID Mobile Left"
            },
            {
               "type":"richtext",
               "id":"content_ml",
               "label":"Content Mobile Left"
            },
            {
               "type":"image_picker",
               "id":"image_ml",
               "label":"Image Mobile Left"
            }
         ]
      },
      {
         "name":"Slides Right Mobile",
         "type":"slds",
         "settings":[
            {
               "type":"text",
               "id":"lnk",
               "label":"Link Mobile Right"
            },
            {
               "type":"text",
               "id":"number",
               "label":"Number Mobile Right"
            },
            {
               "type":"text",
               "id":"ttl",
               "label":"Title Mobile Right"
            },
            {
               "type":"text",
               "id":"linked_idmr",
               "label":"Linked ID Mobile Right"
            },
            {
               "type":"richtext",
               "id":"cnt",
               "label":"Content Mobile Right"
            },
            {
               "type":"image_picker",
               "id":"imgmr",
               "label":"Image Mobile Right"
            }
         ]
      }
    
   ],
   "presets":[
      {
         "name":"Supplements"
      }
   ]
}
{% endschema %}