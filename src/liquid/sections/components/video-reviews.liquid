<section class="video-reviews-section">
  <div class="container">
    <h2>{{ section.settings.title }}</h2>

    <div class="video-reviews swiper swiper-loading" data-swiper-section="{{ section.id }}-videos">
      <div class="swiper-button-prev"></div>
      <div class="swiper-wrapper">
        {% for block in section.blocks %}
          <div class="swiper-slide">
            <div class="video-review">
              <div class="review-video">
                <iframe src="{{ block.settings.vidURL | escape }}" width="640" height="640" frameborder="0" allow="autoplay; fullscreen" allowfullscreen="" class="fluidvids-item" data-fluidvids="loaded" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen title="{{ block.settings.video_title }}"></iframe>
              </div>
              <div class="review-quote">
                <img src="{{ section.settings.quote_image | img_url }}" alt="" loading="lazy">
                <p class="quote-content">{{ block.settings.quote_content }}</p>
                <p class="quote-author">{{ block.settings.quote_author }}</p>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
      <div class="swiper-button-next"></div>

      <div class="swiper-loader">
        <div class="swiper-loader-spinner">
          <div class="swiper-loader-bounce1"></div>
          <div class="swiper-loader-bounce2"></div>
          <div class="swiper-loader-bounce3"></div>
        </div>
      </div>
    </div>
  </div>
</section>


<style>
  .video-reviews-section .swiper-button-prev, .video-reviews-section .swiper-button-next {
    color: {{ section.settings.arrow_color }};
    transition: opacity .5s;
  }

  .video-reviews-section .swiper-button-prev.disabled, .video-reviews-section .swiper-button-next.disabled {
    opacity: 0;
  }

  .video-reviews-section .swiper-button-prev::after, .video-reviews-section .swiper-button-next::after {
    font-size: 28px;
  }

  .video-reviews-section .video-reviews .video-review .review-video iframe {
    width: 100% !important;
    height: 100% !important;
  }

  .video-reviews-section .video-reviews .video-review .review-quote {
    padding: 50px;
    width: 50%;
    font-size: 22px;
    position: relative;
  }

  .video-reviews-section .video-reviews .video-review .review-quote img {
    opacity: .1;
    width: 70px;
    position: absolute;
    left: 50px;
  }

  .video-reviews-section .container .video-reviews {
    overflow: visible;
    max-width: 70%;
  }

  .video-reviews-section .container .video-reviews .swiper-slide .video-review {
      display: flex;
      align-items: center;
  }

  .video-reviews-section .container .video-reviews .swiper-slide .video-review .review-video {
      width: 60%;
      margin-left: 10%;
      height: 500px
  }

  @media screen and (max-width: 768px) {
    .video-reviews-section .container .video-reviews {
      max-width: unset;
    }

    .video-reviews-section .container .video-reviews .swiper-slide .video-review {
      flex-direction: column;
      max-width: 80%;
      margin: auto;
      text-align: center
    }

    .video-reviews-section .container .video-reviews .swiper-slide .video-review .review-video {
      width: unset;
      margin-left: unset;
      height: 300px;
      margin-bottom: 10px
    }

    .video-reviews-section .container .video-reviews .swiper-slide .video-review .review-quote {
      padding: unset;
      width: 100%;
    }

    .video-reviews-section .container .video-reviews .swiper-slide .video-review .review-quote img {
      width: 40px;
      left: -10px;
      top: 0
    }

    .video-reviews-section {
      background-color: {{ section.settings.bg_color }};

    }

    .video-reviews-section h2 {
      text-align: center;
    }
  }
</style>

{% comment %}
  Add lazy loading support
{% endcomment %}
{% render 'layout.head.swiper-dynamic', selector: '.video-reviews-section .swiper' %}

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const swiperEl = document.querySelector('.video-reviews-section .swiper');
    if (!swiperEl) return;

    // Add data attributes for the Swiper options
    swiperEl.dataset.swiperOptions = JSON.stringify({
      slidesPerView: 'auto',
      spaceBetween: 8,
      centeredSlides: true,
      grabCursor: true,
      slideToClickedSlide: true,
      loop: false,
      navigation: {
        nextEl: '.video-reviews-section .swiper-button-next',
        prevEl: '.video-reviews-section .swiper-button-prev',
        disabledClass: 'disabled'
      }
    });

    // Let the observer handle initialization if element is not in viewport
    if (window.swiperObserver && !swiperEl.dataset.swiperObserved) {
      window.swiperObserver.observe(swiperEl);
      swiperEl.dataset.swiperObserved = 'pending';
    } else {
      // Fallback to manual initialization
      loadSwiper(() => {
        window.initializeSwiper('.video-reviews-section .swiper',
          JSON.parse(swiperEl.dataset.swiperOptions));
      });
    }
  });
</script>


{% schema %}
{
  "name": "Video Reviews Section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background Color"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title Color",
      "default": "#404733"
    },
    {
      "type": "color",
      "id": "arrow_color",
      "label": "Arrow Color",
      "default": "#808080"
    },

    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Customers Reviews Of Curalin"
    },
    {
      "type": "image_picker",
      "id": "quote_image",
      "label": "Quote Image"
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Video Slide",
      "settings": [
        {
          "type": "text",
          "id": "vidURL",
          "label": "Video URL"
        },

        {
          "type": "text",
          "id": "video_title",
          "label": "Video Title"
        },
        {
          "type": "text",
          "id": "quote_content",
          "label": "Quote Content"
        },
        {
          "type": "text",
          "id": "quote_author",
          "label": "Quote Author"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Video Rewievs"
    }
  ]
}
{% endschema %}

