{% if shop.name == 'CuraLife Global' %}
  {% if section.settings.is_hide_on_global %}
    {% assign hideSection = true %}
  {% elsif section.settings.section_additional_classes contains 'prime' or section.settings.section_additional_classes contains 'subscription' %}
    {% assign hideSection = true %}
  {% endif %}
{% elsif section.settings.display_on_pages != blank %}
  {% assign isDisplayOnThisPage = false %}
  {% assign displayOnPagesArray = section.settings.display_on_pages | split: ',' %}
  {% for currentPage in displayOnPagesArray %}
    {% if currentPage == request.path %}
      {% assign isDisplayOnThisPage = true %}
    {% endif %}
  {% endfor %}

  {% unless isDisplayOnThisPage %}
    {% assign hideSection = true %}
  {% endunless %}
{% endif %}

{% unless hideSection %}
  <section id="section-{{ section.id }}" class="items-collection {% if section.settings.is_decor_relative_full %}static{% endif %} {{ section.settings.section_additional_classes }}">
    <div class="container main-container {% if section.settings.is_decor_relative_full %}static{% endif %}">
      {% if section.settings.main_title != blank %}
        {% render 'title', section_id: section.id, title: section.settings.main_title, title_tag: 'h2', subtitle: section.settings.main_subtitle, title_swoosh_color: section.settings.title_swoosh_color, span_color: section.settings.title_highlight_color, padding_bottom: '30', padding_top: 0 %}
      {% endif %}

      <{% if section.settings.is_slider %}swiper-container{% else %}div{% endif %} class="items z-10 flex flex-wrap {% if section.settings.items_align == 'center' %}items-center{% else %}items-start{% endif %} justify-center m-auto overflow-visible" {% if section.settings.is_slider %}centered-slide="true" slides-per-view="auto" auto-height="{{ section.settings.is_auto_height }}" {% if section.settings.is_arrows %}navigation="true"{% endif %} {% if section.settings.is_dots %}pagination="true" pagination-clickable="true"{% endif %} {% if section.settings.is_ticker %}autoplay="{ delay: 1000, disableOnInteraction: false }"{% endif %} lazy="true"{% endif %}>
        {% for block in section.blocks %}
          {% if block.settings.link_url %}<a class="contents" href="{{ block.settings.link_url }}">{% endif %}
          <{% if section.settings.is_slider %}swiper-slide{% else %}div{% endif %} class="item relative {% if block.settings.is_hide_on_mobile %}md:hidden{% endif %}">
            <div class="item-content flex flex-col items-center justify-{% if section.settings.item_layout_mobile == 'row' %}start{% else %}center{% endif %} p-4 md:p-1 text-center gap-4 m-auto">
              <div class="img-wrapper">
                {% if block.settings.image %}<img class="max-h-250px m-0" src="{{ block.settings.image | image_url }}" alt="{{ block.settings.image.alt }}" loading="lazy">{% endif %}
                {% if block.settings.icon != blank %}<i class="{{ block.settings.icon }}"></i>{% endif %}
              </div>
              {% if block.settings.title != blank or block.settings.description != blank or block.settings.link_title != blank %}
                <div class="text-wrapper flex flex-col gap-2 {% if section.settings.item_layout_mobile == 'row' %}md:items-start md:w-[70vw]{% endif %}">
                  {% if block.settings.title != blank %}<{{ section.settings.title_tag }} class="title-tag m-0">{{ block.settings.title }}</{{ section.settings.title_tag }}>{% endif %}
                  {% if block.settings.description != blank %}<div class="description">{{ block.settings.description }}</div>{% endif %}
                  {% if block.settings.link_title != blank %}<a class="btn btn--secondary underline" href="{{ block.settings.link_url }}">{{ block.settings.link_title }}</a>{% endif %}
                </div>
              {% endif %}
            </div>
          </{% if section.settings.is_slider %}swiper-slide{% else %}div{% endif %}>
          {% if block.settings.link_url %}</a>{% endif %}
        {% endfor %}
      </{% if section.settings.is_slider %}swiper-container{% else %}div{% endif %}>

      {% if section.settings.decor_img %}
        <img class="decor-img {% if section.settings.is_decor_remove_on_mobile %}md:hidden{% endif %} {% if section.settings.is_decor_bg %}w-full h-full object-cover{% endif %}" src="{{ section.settings.decor_img | image_url }}" alt="{{ section.settings.decor_img.alt }}" loading="lazy">
      {% endif %}
    </div>
  </section>

  {% if section.settings.is_slider %}
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-element-bundle.min.js"></script>
  {% endif %}


  <style>
    #section-{{ section.id }} .items a {
      display: contents;
    }

    #section-{{ section.id }} .items {
      --swiper-theme-color: #000;
      --swiper-pagination-bottom: -9%;
      --swiper-navigation-size: 18px;
      --swiper-navigation-top-offset: 50%;
      --swiper-navigation-sides-offset: 0;

      width: {{ section.settings.collection_width }}%;
      row-gap: {{ section.settings.row_gap }}rem;
    }

    #section-{{ section.id }} {
      background-color: {{ section.settings.bg_color }};
    }

    {% if section.settings.container_color != blank %}
      #section-{{ section.id }} .main-container {
        background-color: {{ section.settings.container_color }};
        border: 1px solid black;
        border-radius: 10px;
        padding: 30px;
      }

      @media screen and (max-width: 768px) {
        #section-{{ section.id }} .main-container {
          width: 90vw;
          padding: 5vw;
        }
      }
    {% endif %}

    #section-{{ section.id }} .item {
      width: calc(100% / {% if section.settings.items_in_row == 'all' %}{{ section.blocks.size }}{% else %}{{ section.settings.items_in_row }}{% endif %});
    }

    #section-{{ section.id }} .item-content {
      max-width: {{ section.settings.item_content_width }}%;
      flex-direction: {{ section.settings.item_layout }};
      text-align: {{ section.settings.item_content_align }};
      color: {{ section.settings.text_color }};
    }

    #section-{{ section.id }} .item-content svg {
      font-size: 30px;
    }

    .items-collection .item-content .text-wrapper strong {
      background: var(--dark-green);
      color: white;
      border-radius: 5px;
      padding: 0 5px;
      font-size: 0.8em;
      position: relative;
      bottom: 0.1em;
    }

    {% if section.settings.padding_top != 50 and section.settings.padding_top != blank %}
      #section-{{ section.id }} {
        padding-top: {{ section.settings.padding_top }}px;
      }
    {% endif %}

    {% if section.settings.padding_bottom != 50 and section.settings.padding_top != blank %}
      #section-{{ section.id }} {
        padding-bottom: {{ section.settings.padding_bottom }}px;
      }
    {% endif %}

    {% if section.settings.padding_top_mobile != blank %}
      @media screen and (max-width: 768px) {
        #section-{{ section.id }} {
          padding-top: {{ section.settings.padding_top_mobile }}vw;
        }
      }
    {% endif %}

    {% if section.settings.padding_bottom_mobile != blank %}
      @media screen and (max-width: 768px) {
        #section-{{ section.id }} {
          padding-bottom: {{ section.settings.padding_bottom_mobile }}vw;
        }
      }
    {% endif %}

    {% if section.settings.is_remove_padding_bottom %}
      #section-{{ section.id }} {
        padding-bottom: 0;
      }
    {% endif %}

    {% if section.settings.is_remove_padding_top %}
      #section-{{ section.id }} {
        padding-top: 0;
      }
    {% endif %}

    @media screen and (max-width: 768px) {
      #section-{{ section.id }} .items {
        width: 100%;
      }

      #section-{{ section.id }} .item {
        {% assign itemsOnMobileCounter = section.blocks.size %}
        {% for block in section.blocks %}
          {% if block.settings.is_hide_on_mobile %}
            {% assign itemsOnMobileCounter = itemsOnMobileCounter | minus: 1 %}
          {% endif %}
        {% endfor %}
        width: calc(100% / {% if section.settings.items_in_row_mobile == 'all' %}{{ itemsOnMobileCounter }}{% else %}{{ section.settings.items_in_row_mobile }}{% endif %});
        max-width: unset;
      }

      #section-{{ section.id }} .item-content {
        flex-direction: {{ section.settings.item_layout_mobile }};
        text-align: {{ section.settings.item_content_align_mobile }};
        max-width: unset;
      }

      #section-{{ section.id }} .item-content .title-tag {
        margin: unset;
      }

      {% if section.settings.items_in_row_mobile == 'all' %}
        #section-{{ section.id }} .item-content .title-tag {
          font-size: 3vw;
          min-height: 7vw;
        }
      {% endif %}
    }
  </style>

  {% if section.settings.is_bigger_center_item %}
  {% assign centerPosition = section.blocks.size | divided_by: 2 | plus: 1 %}
  {% assign centerElementSelector = "swiper-slide[aria-label='" | append: centerPosition | append: " / " | append: section.blocks.size | append: "']" %}
    <style>
      #section-{{ section.id }} swiper-slide img {
        transition: .7s;
      }

      #section-{{ section.id }} swiper-container {
        margin-top: 30px;
      }

      #section-{{ section.id }} {{ centerElementSelector }} img {
        z-index: 1;
        transform: scale(1.3);
      }

      #section-{{ section.id }} {{ centerElementSelector }} .title-tag {
        margin-top: 1.5em;
      }

      @media screen and (max-width: 768px) {
        {% if section.settings.is_bigger_center_item %}
          #section-{{ section.id }} swiper-container {
            padding-bottom: 10vw;
          }
        {% endif %}

        #section-{{ section.id }} swiper-slide {
          padding: 0 10px;
        }

        #section-{{ section.id }} swiper-slide img {
          transform: scale(0.8);
          margin-bottom: -2em;
        }

        #section-{{ section.id }} {{ centerElementSelector }} img {
          transform: scale(0.8);
        }

        #section-{{ section.id }} {{ centerElementSelector }} .title-tag {
          margin-top: 0;
        }

        #section-{{ section.id }} swiper-slide.swiper-slide-active img {
          transform: scale(1) !important;
          margin-bottom: 0;
        }
      }
    </style>
  {% endif %}

  {% if section.settings.decor_img %}
    <style>
      #section-{{ section.id }} .decor-img {
        position: absolute;
        z-index: {% if section.settings.is_decor_above %}2{% else %}1{% endif %};
        top: {{ section.settings.decor_position_top }}%;
        left: {{ section.settings.decor_position_left }}%;
        opacity: {{ section.settings.decor_opacity }}%;
        max-width: {{ section.settings.decor_max_width }}%;
      }

      @media screen and (max-width: 768px) {
        #section-{{ section.id }} .decor-img {
          top: {{ section.settings.decor_position_top_mobile }}%;
          left: {{ section.settings.decor_position_left_mobile }}%;
        }
      }
    </style>
  {% endif %}
{% endunless %}

{% schema %}
{
  "name": "Items collection",
  "class": "items-collection relative",
  "settings": [
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background Color"
    },
    {
      "type": "color",
      "id": "container_color",
      "label": "Container Color"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color"
    },
    {
      "type": "header",
      "content": "Main Title"
    },
    {
      "type": "text",
      "id": "main_title",
      "label": "Main Title"
    },
    {
      "type": "text",
      "id": "main_subtitle",
      "label": "Main Subtitle"
    },
    {
      "type": "color",
      "id": "title_highlight_color",
      "label": "Title Highlight Color (<strong>)"
    },
    {
      "type": "select",
      "id": "title_swoosh_color",
      "label": "Title Decoration Color (<strong>)",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "grey",
          "label": "Grey"
        },
        {
          "value": "white",
          "label": "White"
        },
        {
          "value": "brown",
          "label": "Brown"
        },
        {
          "value": "green",
          "label": "Green"
        },
        {
          "value": "dark-green",
          "label": "Dark Green"
        }
      ],
      "default": "none"
    },
    {
      "type": "select",
      "id": "item_layout",
      "label": "Item Layout",
      "options": [
        {
          "value": "column",
          "label": "Vertical"
        },
        {
          "value": "row",
          "label": "Horizontal"
        }
      ],
      "default": "column"
    },
    {
      "type": "select",
      "id": "items_align",
      "label": "Items Alignment",
      "options": [
        {
          "value": "start",
          "label": "Start"
        },
        {
          "value": "center",
          "label": "Center"
        }
      ],
      "default": "start"
    },
    {
      "type": "select",
      "id": "item_layout_mobile",
      "label": "Item Layout on Mobile",
      "options": [
        {
          "value": "column",
          "label": "Vertical"
        },
        {
          "value": "row",
          "label": "Horizontal"
        }
      ],
      "default": "column"
    },
    {
      "type": "select",
      "id": "item_content_align",
      "label": "Item Conetnt Alignment",
      "options": [
        {
          "value": "start",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "item_content_align_mobile",
      "label": "Item Conetnt Alignment on Mobile",
      "options": [
        {
          "value": "start",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "title_tag",
      "label": "Title Tag",
      "options": [
        {
          "value": "h3",
          "label": "H3"
        },
        {
          "value": "h4",
          "label": "H4"
        },
        {
          "value": "h5",
          "label": "H5"
        },
        {
          "value": "h6",
          "label": "H6"
        },
        {
          "value": "p",
          "label": "P"
        }
      ],
      "default": "h5"
    },
    {
      "type": "select",
      "id": "items_in_row",
      "label": "Items In Row",
      "options": [
        {
          "value": "1",
          "label": "1"
        },
        {
          "value": "2",
          "label": "2"
        },
        {
          "value": "3",
          "label": "3"
        },
        {
          "value": "4",
          "label": "4"
        },
        {
          "value": "5",
          "label": "5"
        },
        {
          "value": "all",
          "label": "All"
        }
      ],
      "default": "all"
    },
    {
      "type": "select",
      "id": "items_in_row_mobile",
      "label": "Items In Row - On Mobile",
      "options": [
        {
          "value": "1",
          "label": "1"
        },
        {
          "value": "2",
          "label": "2"
        },
        {
          "value": "3",
          "label": "3"
        },
        {
          "value": "all",
          "label": "All"
        }
      ],
      "default": "1"
    },
    {
      "type": "range",
      "id": "row_gap",
      "label": "Row Gap",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "range",
      "id": "collection_width",
      "label": "Collection Width",
      "min": 50,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 100
    },
    {
      "type": "range",
      "id": "item_content_width",
      "label": "Item Content Width",
      "min": 50,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 100
    },
    {
      "type": "header",
      "content": "Slider Settings"
    },
    {
      "type": "checkbox",
      "id": "is_slider",
      "label": "Slider Functionality"
    },
    {
      "type": "checkbox",
      "id": "is_ticker",
      "label": "Slider Ticker Animation"
    },
    {
      "type": "checkbox",
      "id": "is_arrows",
      "label": "Show Arrows",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "is_dots",
      "label": "Show Dots",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "is_auto_height",
      "label": "Auto Height"
    },
    {
      "type": "checkbox",
      "id": "is_bigger_center_item",
      "label": "Bigger Center Item"
    },
    {
      "type": "header",
      "content": "Section Settings"
    },
    {
      "type": "text",
      "id": "section_additional_classes",
      "label": "Additional Classes"
    },
    {
      "type": "header",
      "content": "Visibility"
    },
    {
      "type": "checkbox",
      "id": "is_hide_on_global",
      "label": "Hide Section On Global"
    },
    {
      "type": "text",
      "id": "display_on_pages",
      "label": "Display Only On Pages",
      "info": "Comma separated list of page paths to display this section only on those pages. blank = all pages."
    },
    {
      "type": "header",
      "content": "Padding"
    },
    {
      "type": "number",
      "id": "padding_top",
      "label": "Padding Top (px unit)",
      "default": 50
    },
    {
      "type": "number",
      "id": "padding_bottom",
      "label": "Padding Bottom (px unit)",
      "default": 50
    },
    {
      "type": "number",
      "id": "padding_top_mobile",
      "label": "Padding Top on Mobile (vw unit)"
    },
    {
      "type": "number",
      "id": "padding_bottom_mobile",
      "label": "Padding Bottom on Mobile (vw unit)"
    },
    {
      "type": "checkbox",
      "id": "is_remove_padding_top",
      "label": "Remove padding top"
    },
    {
      "type": "checkbox",
      "id": "is_remove_padding_bottom",
      "label": "Remove padding bottom"
    },
    {
      "type": "header",
      "content": "Decoration Image"
    },
    {
      "type": "image_picker",
      "id": "decor_img",
      "label": "Decoration Image"
    },
    {
      "type": "range",
      "id": "decor_opacity",
      "label": "Decoration Opacity",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "default": 100
    },
    {
      "type": "range",
      "id": "decor_max_width",
      "label": "Decoration Maximum Width",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "default": 50
    },
    {
      "type": "range",
      "id": "decor_position_top",
      "label": "Decoration Position Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "default": 0
    },
    {
      "type": "range",
      "id": "decor_position_left",
      "label": "Decoration Position Left",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "default": 0
    },
    {
      "type": "range",
      "id": "decor_position_top_mobile",
      "label": "Decoration Mobile Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "default": 0
    },
    {
      "type": "range",
      "id": "decor_position_left_mobile",
      "label": "Decoration Mobile Left",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "default": 0
    },
    {
      "type": "checkbox",
      "id": "is_decor_above",
      "label": "Decoration Above Content"
    },
    {
      "type": "checkbox",
      "id": "is_decor_bg",
      "label": "Decoration is a Background"
    },
    {
      "type": "checkbox",
      "id": "is_decor_relative_full",
      "label": "Decoration Relative to Full Width"
    },
    {
      "type": "checkbox",
      "id": "is_decor_remove_on_mobile",
      "label": "Remove Decoration On Mobile"
    }
  ],
  "blocks": [
    {
      "type": "item",
      "name": "Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "icon",
          "label": "Icon (class)"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        },
        {
          "type": "text",
          "id": "description",
          "label": "Description"
        },
        {
          "type": "checkbox",
          "id": "is_hide_on_mobile",
          "label": "Hide on mobile"
        },
        {
          "type": "text",
          "id": "link_title",
          "label": "Link Title"
        },
        {
          "type": "url",
          "id": "link_url",
          "label": "Link URL"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Items collection"
    }
  ]
}
{% endschema %}