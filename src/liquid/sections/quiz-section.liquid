{{ 'quiz.js' | asset_url | script_tag }}

<div
	id="product-quiz"
	class="font-sans text-slate-800 leading-normal max-w-4xl mx-auto"
	data-quiz-url="{{ 'dietitian-quiz.json' | asset_url }}"
	data-n8n-webhook="{{ section.settings.n8n_webhook_url }}"
	data-booking-url="{{ section.settings.booking_url }}">
	<!-- Quiz Intro -->
	<div class="text-center py-12 px-4 mx-auto quiz-intro">
		<h2 class="text-4xl font-bold mb-4 leading-tight md:text-5xl">{{ section.settings.title }}</h2>
		<p class="text-lg text-slate-500 max-w-xl mx-auto mb-8">{{ section.settings.description }}</p>
		<button id="quiz-start-button" class="inline-flex items-center justify-center px-6 py-3 text-base font-medium rounded-lg bg-slate-800 text-white hover:bg-slate-700 transition duration-200">
			{{ section.settings.button_text }}
			<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-2">
				<path d="M5 12h14M12 5l7 7-7 7"/>
			</svg>
		</button>
	</div>

	<!-- Loading Indicator -->
	<div class="flex flex-col items-center justify-center py-12 px-4 hidden quiz-loading">
		<div class="w-10 h-10 border-4 border-slate-200 border-l-slate-800 rounded-full animate-spin mb-4"></div>
		<p>Loading quiz...</p>
	</div>

	<!-- Error Message -->
	<div class="text-center py-8 px-4 max-w-md mx-auto hidden quiz-error">
		<h3 class="text-xl font-semibold text-red-500 mb-2">Error</h3>
		<p class="text-slate-500 mb-6">Failed to load quiz data. Please try again later.</p>
		<button class="px-6 py-3 text-base font-medium rounded-lg bg-slate-800 text-white hover:bg-slate-700 transition duration-200" onclick="window.location.reload()">Retry</button>
	</div>

	<!-- Quiz Questions -->
	<div class="hidden min-h-[400px] bg-white rounded-lg shadow-md mx-auto max-w-4xl w-full my-8 quiz-questions">
		<div class="h-1 bg-slate-200 rounded-t-lg overflow-hidden quiz-progress-container">
			<div class="h-full bg-slate-800 w-0 transition-width duration-300 quiz-progress-bar"></div>
		</div>

		<div class="p-8 quiz-question-container">
			<!-- Question will be inserted here by JavaScript -->
		</div>

		<div class="flex justify-between px-8 pb-8 quiz-navigation">
			<button
				class="inline-flex items-center px-6 py-3 text-base font-medium rounded-lg bg-white text-slate-800 border border-slate-200 hover:bg-slate-100 transition duration-200"
				id="quiz-prev-button">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					width="16"
					height="16"
					viewBox="0 0 24 24"
					fill="none"
					stroke="currentColor"
					stroke-width="2"
					stroke-linecap="round"
					stroke-linejoin="round"
					class="mr-2">
					<path d="M19 12H5M12 19l-7-7 7-7"/>
				</svg>
				Back
			</button>
			<button class="inline-flex items-center px-6 py-3 text-base font-medium rounded-lg bg-slate-800 text-white hover:bg-slate-700 transition duration-200" id="quiz-next-button">
				Next
				<svg
					xmlns="http://www.w3.org/2000/svg"
					width="16"
					height="16"
					viewBox="0 0 24 24"
					fill="none"
					stroke="currentColor"
					stroke-width="2"
					stroke-linecap="round"
					stroke-linejoin="round"
					class="ml-2">
					<path d="M5 12h14M12 5l7 7-7 7"/>
				</svg>
			</button>
		</div>
	</div>

	<div class="hidden max-w-4xl mx-auto my-8 px-4 py-8 quiz-results">
		<!-- Results content will be injected here by JavaScript -->
	</div>
</div>

{% schema %}
	{
		"name": "Dietitian Quiz",
		"settings": [
			{
				"type": "text",
				"id": "title",
				"label": "Quiz Title",
				"default": "Find Your Perfect Dietitian"
			},
			{
				"type": "textarea",
				"id": "description",
				"label": "Quiz Description",
				"default": "Answer a few quick questions so we can match you with the right registered dietitian, confirm your insurance benefits, and help you pay $0 out-of-pocket."
			},
			{
				"type": "text",
				"id": "button_text",
				"label": "Start Button Text",
				"default": "Start Quiz"
			},
			{
				"type": "text",
				"id": "booking_url",
				"label": "Appointment Booking URL",
				"default": "/appointment-booking",
				"info": "Where to send users after completing the quiz"
			},
			{
				"type": "text",
				"id": "n8n_webhook_url",
				"label": "N8N Webhook URL",
				"default": "https://n8n.curalife.com/webhook/quiz-webhook",
				"info": "URL to send quiz responses to your n8n workflow"
			}
		],
		"presets": [
			{
				"name": "Dietitian Quiz",
				"category": "Interactive"
			}
		]
	}
{% endschema %}
