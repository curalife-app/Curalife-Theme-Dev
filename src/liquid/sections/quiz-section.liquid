{{ 'quiz.js' | asset_url | script_tag }}
{{ 'quiz.css' | asset_url | stylesheet_tag }}

<div
	id="quiz-container"
	class="quiz-main-container"
	data-quiz-url="{{ section.settings.quiz_data_url | default: 'dietitian-quiz.json' | asset_url }}"
	data-webhook-url="{{ section.settings.webhook_url }}"
	data-test-webhook-url="{{ section.settings.test_webhook_url }}"
	data-user-creation-url="{{ section.settings.user_creation_url }}"
	data-result-url="{{ section.settings.result_url }}"
	data-notifications-url="{{ 'notifications.js' | asset_url }}">
	<!-- Status Check Indicator -->
	<div class="quiz-status-check hidden">
		<div class="quiz-loading-spinner"></div>
		<h3 class="quiz-status-title">Processing</h3>
		<p class="quiz-status-description">We're processing your request. This may take a moment...</p>
	</div>

	<!-- Error Message -->
	<div class="quiz-error hidden">
		<h3 class="quiz-error-title">Error</h3>
		<p class="quiz-error-description">Failed to load quiz data. Please try again later.</p>
		<button class="quiz-retry-button" onclick="window.location.reload()">Retry</button>
	</div>

	<!-- Navigation Header -->
	<div class="quiz-nav-header hidden" id="quiz-nav-header">
		<div class="quiz-nav-header-content">
			<button class="quiz-back-button" id="quiz-back-button">
				<div class="quiz-back-button-content">
					<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path d="M3.33301 10H16.6663" stroke="#454545" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"/>
						<path d="M8.33301 5L3.33301 10L8.33301 15" stroke="#454545" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"/>
					</svg>
					<span class="quiz-back-button-text">Back</span>
				</div>
			</button>

			<!-- Logo space - empty for now -->
			<img src="{{ 'curalife-logo-grey.svg' | file_url }}" alt="CuraLife Logo" class="quiz-logo">
		</div>
	</div>

	<!-- Progress Bar (separate from header) -->
	<div class="quiz-progress-section hidden" id="quiz-progress-section">
		<div class="quiz-progress-wrapper">
			<div class="quiz-progress-container">
				<div class="quiz-progress-bar"></div>
				<div class="quiz-progress-indicator"></div>
			</div>
		</div>
	</div>

	<!-- Loading Indicator -->
	<div class="quiz-loading hidden">
		<div class="quiz-loading-spinner"></div>
		<p class="quiz-loading-text">Loading quiz...</p>
	</div>

	<!-- Quiz Questions -->
	<div class="quiz-questions hidden">
		<!-- Question Content -->
		<div class="quiz-question-container">
			<!-- Question will be inserted here by JavaScript -->
		</div>

		<!-- Navigation -->
		<div class="quiz-navigation">
			<button class="quiz-nav-button quiz-nav-button--primary" id="quiz-next-button">Next</button>
		</div>
	</div>

	<!-- Results Section -->
	<div class="quiz-results hidden">
		<!-- Results content will be injected here by JavaScript -->
	</div>
</div>

{% schema %}
	{
		"name": "Modular Quiz",
		"settings": [
			{
				"type": "text",
				"id": "quiz_data_url",
				"label": "Quiz Data JSON File",
				"default": "dietitian-quiz.json",
				"info": "Name of the JSON file containing quiz questions and configuration (stored in assets)"
			},
			{
				"type": "text",
				"id": "result_url",
				"label": "Results/Completion URL",
				"default": "/quiz-complete",
				"info": "Where to send users after completing the quiz"
			},
			{
				"type": "text",
				"id": "webhook_url",
				"label": "Eligibility Webhook URL (Optional)",
				"info": "URL to send eligibility requests for processing (leave empty if no backend processing needed)"
			},
			{
				"type": "text",
				"id": "test_webhook_url",
				"label": "Test Eligibility Webhook URL (Optional)",
				"info": "URL to send test eligibility requests. When provided, test mode (?test=xxx) will use this URL and force test Stedi API key usage."
			},
			{
				"type": "text",
				"id": "user_creation_url",
				"label": "User Creation Webhook URL (Optional)",
				"info": "URL to send user creation requests for processing (can be same as eligibility URL with different endpoint)"
			}
		],
		"presets": [
			{
				"name": "Modular Quiz",
				"category": "Interactive"
			}
		]
	}
{% endschema %}
