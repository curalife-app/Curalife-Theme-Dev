{{ 'quiz.css' | asset_url | stylesheet_tag }}
{{ 'quiz.js' | asset_url | script_tag }}

<div
	id="product-quiz"
	class="quiz-container"
	data-quiz-url="{{ 'dietitian-quiz.json' | asset_url }}"
	data-n8n-webhook="{{ section.settings.n8n_webhook_url }}"
	data-booking-url="{{ section.settings.booking_url }}">
	<!-- Quiz Intro -->
	<div class="quiz-intro">
		<h2>{{ section.settings.title }}</h2>
		<p>{{ section.settings.description }}</p>
		<button id="quiz-start-button" class="quiz-btn quiz-btn-primary">
			{{ section.settings.button_text }}
			<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
				<path d="M5 12h14M12 5l7 7-7 7"/>
			</svg>
		</button>
	</div>

	<!-- Loading Indicator -->
	<div class="quiz-loading" style="display: none;">
		<div class="quiz-spinner"></div>
		<p>Loading quiz...</p>
	</div>

	<!-- Error Message -->
	<div class="quiz-error" style="display: none;">
		<h3 class="quiz-error-title">Error</h3>
		<p class="quiz-error-message">Failed to load quiz data. Please try again later.</p>
		<button class="quiz-btn quiz-btn-primary" onclick="window.location.reload()">Retry</button>
	</div>

	<!-- Quiz Questions -->
	<div class="quiz-questions">
		<div class="quiz-progress-container">
			<div class="quiz-progress-bar"></div>
		</div>

		<div class="quiz-question-container">
			<!-- Question will be inserted here by JavaScript -->
		</div>

		<div class="quiz-navigation">
			<button class="quiz-btn quiz-btn-secondary" id="quiz-prev-button">
				<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
					<path d="M19 12H5M12 19l-7-7 7-7"/>
				</svg>
				Back
			</button>
			<button class="quiz-btn quiz-btn-primary" id="quiz-next-button">
				Next
				<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
					<path d="M5 12h14M12 5l7 7-7 7"/>
				</svg>
			</button>
		</div>
	</div>

	<!-- Quiz Results -->
	<div class="quiz-results" style="display: none;">
		<!-- Results content will be injected here by JavaScript -->
	</div>
</div>

{% schema %}
	{
		"name": "Dietitian Quiz",
		"settings": [
			{
				"type": "text",
				"id": "title",
				"label": "Quiz Title",
				"default": "Find Your Perfect Dietitian"
			},
			{
				"type": "textarea",
				"id": "description",
				"label": "Quiz Description",
				"default": "Answer a few quick questions so we can match you with the right registered dietitian, confirm your insurance benefits, and help you pay $0 out-of-pocket."
			},
			{
				"type": "text",
				"id": "button_text",
				"label": "Start Button Text",
				"default": "Start Quiz"
			},
			{
				"type": "url",
				"id": "booking_url",
				"label": "Appointment Booking URL",
				"default": "/appointment-booking",
				"info": "Where to send users after completing the quiz"
			},
			{
				"type": "text",
				"id": "n8n_webhook_url",
				"label": "N8N Webhook URL",
				"default": "https://n8n.curalife.com/webhook/quiz-webhook",
				"info": "URL to send quiz responses to your n8n workflow"
			}
		],
		"presets": [
			{
				"name": "Dietitian Quiz",
				"category": "Interactive"
			}
		]
	}
{% endschema %}
