{% layout 'theme.lps' %}
{% if shop.name == "CuraLife" %}
  {% assign curaeats_value = 29 %}
  {% assign challenge_value = 99 %}
{% elsif shop.name == "CuraLife Global" %}
  {% assign curaeats_value = 24 %}
{% endif %}

{% assign Prods = page.content | split: ',' %}

{% render 'products-catalog-section', Prods: Prods, challenge_value: challenge_value, curaeats_value: curaeats_value %}
{% comment %} {% render 'bundle-gifts-section', isArrow: true, challenge_value: 99, curaeats_value: 29 %} {% endcomment %}






<script>
  let urlParams = new URLSearchParams(window.location.search);
  let linksAddition = urlParams.get('add');

  if (linksAddition) {
    $('a').each(function () {
      var currLink = $(this).attr('href');
      if (currLink) { $(this).attr('href', currLink + linksAddition) };
    });
  }
</script>

<script>
  $(document).on("click", ".cta-btn", function () {
    console.log("add to cart event");
        window.dataLayer  = window.dataLayer || [];
        window.dataLayer.push({
          'event': 'eec.addToCart',       // name of an event. In this case, always stays as eec.addToCart
          'ecommerce': {                  // ecommerce object. This is the essential part of tracking. New EE data must always be pushed to this object
            'currencyCode': '{{ shop.currency }}',          // the currency which is currently used by a visitor
            'add': {                        // name of an action. In this case, always stays as add
            'actionField': {
            'list': 'main'          // optional. name of a list from which the product was added to a cart
          },
          'products': [{              // list of products added to a cart. Can contain multiple products at the same time
            'name': $(this).attr('prod-title'),      // name of a product that was added to a cart
            'id': $(this).attr('prod-id'),       // id of a product
            'price': $(this).attr('prod-price').substring(1),      // price of a product
            'category': 'Simple',
            'variant': '',   // category of a product
            'quantity': 1
          }]
        }
      },
      'userId': '{{ customer.id }}',
      'email': '{{ customer.email }}',
      'country': '{{customer.customer_address.country_code }}',
      'city': '{{customer.customer_address.city }}',
      'name': '{{ customer.first_name }}',
      'surname': '{{ customer.last_name }}',
      'phone_number': '{{customer.phone }}',
      'state': '{{customer.customer_address.province }}',       //state or province
      'zip': '{{customer.customer_address.zip }}'         //ZIP or Postal code
      });
  });
</script>

<script>
  $( document ).ready(function() {
    $(".rounded").each(function() {
      if ($(this).hasClass("floor")) {
        $(this).text("{{ cart.currency.symbol }}" + Math.floor(Number($(this).text().replace(/[^0-9\.-]+/g,""))));
      }
      else {
        $(this).text("{{ cart.currency.symbol }}" + Math.ceil(Number($(this).text().replace(/[^0-9\.-]+/g,""))));
      }

      if (!$(this).hasClass("no-letters")) { $(this).text($(this).text() + " {{ currency_letters }}") };
      $(this).show();
    });
  });
</script>