{% assign sectionIDParts = section.id | split: '_' %}
{% assign shortSectionID = sectionIDParts[-1] %}
{% assign shortSectionIDParts = shortSectionID | split: '-' %}
{% assign SID = shortSectionIDParts[-1] %}

{% assign prod = section.settings.product | default: product %}
{% assign buyBoxColor = product.metafields.primary_color | default: section.settings.buy_box_color %}

<div id="cta-section-anchor"></div>
<section id="cta-section-{{ SID }}" class="cta-section overflow-visible pb-0 {{ section.settings.additional_classes }}">
  {% render 'product-cta',
    ctaTemplate: section.settings.cta_template,
    bgColor: section.settings.bg_color,
    buyBoxColor: section.settings.buy_box_color,
    ctaColor: section.settings.cta_color,
    ctaTextColor: section.settings.cta_text_color,
    upperTitleNotice: section.settings.upper_title_notice,
    mainTitle: section.settings.main_title,
    ctaText: section.settings.cta_text,
    buttonTitle: section.settings.button_title,
    title: section.settings.variants_title,
    pricePer: section.settings.price_per,
    saveFormat: section.settings.save_format,
    ctaTextType: section.settings.price_format,
    badgeImage: section.settings.badge_image,
    defaultSelectionIndex: section.settings.default_selection_index,
    isSubscription: section.settings.is_subscription,
    isHighlightSubtitle: section.settings.is_highlight_subtitle,
    isReversed: section.settings.is_reverse,
    isReviews: section.settings.is_reviews,
    isSaveTitle: section.settings.is_save_title,
    isProductThumbs: true,
    isHideThumbs: section.settings.is_hide_thumbs,
    isHideInfo: section.settings.is_hide_info,
    isBuyQuantity: section.settings.is_buy_quantity,
    isSlideOnLoad: section.settings.is_slide_on_load,
    isBuyWithPrime: section.settings.is_buy_with_prime,
    isFSA: section.settings.is_fsa,
    buyType: section.settings.buy_type,
    additionalClasses: section.settings.additional_classes,
    blocks: section.blocks,
    prod: prod,
    SID: SID
  %}
</section>

{% schema %}
{
    "name": "CTA Section",
    "disabled_on": {
      "groups": [
        "header",
        "footer"
      ]
    },
    "settings": [
      {
        "type": "product",
        "id": "product",
        "label": "Product"
      },
      {
        "type": "select",
        "id": "cta_template",
        "label": "CTA Template",
        "options": [
          {
            "value": "basic",
            "label": "Basic"
          },
          {
            "value": "info",
            "label": "Information"
          },
          {
            "value": "2024",
            "label": "Subscription"
          },
          {
            "value": "2024-new",
            "label": "Subscription New"
          },
          {
            "value": "2024-new-2",
            "label": "Subscription New 2"
          },
          {
            "value": "2024-new-3",
            "label": "Subscription New 3"
          }
        ],
        "default": "2024"
      },
      {
        "type": "color",
        "id": "bg_color",
        "label": "Background Color"
      },
      {
        "type": "color",
        "id": "buy_box_color",
        "label": "Buy Box Main Color",
        "default": "#3A7684"
      },
      {
        "type": "color",
        "id": "cta_color",
        "label": "Buy Button Color"
      },
      {
        "type": "color",
        "id": "cta_text_color",
        "label": "Buy Button Text Color"
      },
      {
        "type": "text",
        "id": "upper_title_notice",
        "label": "Upper Title Notice"
      },
      {
        "type": "text",
        "id": "main_title",
        "label": "Main Title"
      },
      {
        "type": "text",
        "id": "variants_title",
        "label": "Variants Title"
      },
      {
        "type": "richtext",
        "id": "cta_text",
        "label": "CTA Text"
      },
      {
        "type": "text",
        "id": "button_title",
        "label": "Submit Button Title",
        "default": "SHOP NOW"
      },
      {
        "type": "image_picker",
        "id": "badge_image",
        "label": "Badge Image"
      },
      {
        "type": "select",
        "id": "buy_type",
        "label": "Buy Type",
        "options": [
          {
            "value": "add_to_cart",
            "label": "Add to Cart"
          },
          {
            "value": "buy_now",
            "label": "Buy Now"
          }
        ],
        "default": "add_to_cart"
      },
      {
        "type": "select",
        "id": "price_per",
        "label": "Price Per",
        "options": [
          {
            "value": "dont_split",
            "label": "Do not Split"
          },
          {
            "value": "month",
            "label": "Month"
          },
          {
            "value": "bottle",
            "label": "Bottle"
          }
        ],
        "default": "dont_split"
      },
      {
        "type": "select",
        "id": "save_format",
        "label": "Save Format",
        "options": [
          {
            "value": "percentage",
            "label": "Percentage"
          },
          {
            "value": "money",
            "label": "Money"
          }
        ],
        "default": "percentage"
      },
      {
        "type": "select",
        "id": "price_format",
        "label": "Price Format",
        "options": [
          {
            "value": "total",
            "label": "Total"
          },
          {
            "value": "save",
            "label": "Save"
          }
        ],
        "default": "total"
      },
      {
        "type": "number",
        "id": "default_selection_index",
        "label": "Default Selection Index",
        "default": 1
      },
      {
        "type": "checkbox",
        "id": "is_subscription",
        "label": "Show Subscription",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "is_highlight_subtitle",
        "label": "Is Highlight Subtitle"
      },
      {
        "type": "checkbox",
        "id": "is_reverse",
        "label": "Reverse Variants"
      },
      {
        "type": "checkbox",
        "id": "is_reviews",
        "label": "Show Reviews"
      },
      {
        "type": "checkbox",
        "id": "is_reviews_quotes",
        "label": "Show Reviews Quotes"
      },
      {
        "type": "checkbox",
        "id": "is_save_title",
        "label": "Show Save Title"
      },
      {
        "type": "checkbox",
        "id": "is_hide_thumbs",
        "label": "Is Hide Thumbs"
      },
      {
        "type": "checkbox",
        "id": "is_hide_info",
        "label": "Is Hide Product Info"
      },
      {
        "type": "checkbox",
        "id": "is_buy_quantity",
        "label": "Quantity Selector"
      },
      {
        "type": "checkbox",
        "id": "is_slide_on_load",
        "label": "Slide Image to Selected Variant on Load"
      },
      {
        "type": "checkbox",
        "id": "is_buy_with_prime",
        "label": "Show Buy with Prime"
      },
      {
        "type": "checkbox",
        "id": "is_fsa",
        "label": "Show HSA|FSA Badge"
      },
      {
        "type": "text",
        "id": "additional_classes",
        "label": "Additional Classes"
      }
    ],
    "blocks": [
      {
        "type": "variant",
        "name": "Variant",
        "settings": [
          {
            "type": "product",
            "id": "prod",
            "label": "Product"
          },
          {
            "type": "text",
            "id": "variant_id",
            "label": "Variant ID"
          },
          {
            "type": "text",
            "id": "reveal_on_paths",
            "label": "Paths to Reveal",
            "info": "Comma separated list of paths to reveal this variant on. If empty, variant will be shown on all pages. Example: /products/product-handle"
          }
        ]
      },
      {
        "type": "image",
        "name": "Image",
        "settings": [
          {
            "type": "image_picker",
            "id": "product_img",
            "label": "Product Image"
          }
        ]
      },
      {
        "type": "video",
        "name": "Video",
        "settings": [
          {
            "type": "text",
            "id": "vimeo_video_id",
            "label": "Vimeo Video ID"
          },
          {
            "type": "image_picker",
            "id": "video_thumbnail",
            "label": "Video Thumbnail"
          }
        ]
      }
    ],
    "presets": [
    {
        "name": "CTA Section"
    }
  ]
}
{% endschema %}